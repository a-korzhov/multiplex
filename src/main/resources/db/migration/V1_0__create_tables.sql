CREATE SEQUENCE public.hibernate_sequence INCREMENT 1 START 1 MINVALUE 1;

CREATE TABLE IF NOT EXISTS rooms
(
    id   BIGINT PRIMARY KEY,
    name VARCHAR(30) NOT NULL
);

CREATE TABLE IF NOT EXISTS screenings
(
    id             BIGINT PRIMARY KEY,
    movie_title    VARCHAR(30)                  NOT NULL,
    screening_time TIMESTAMP                    NOT NULL,
    room_id        BIGINT REFERENCES rooms (id) NOT NULL
);


CREATE TABLE IF NOT EXISTS seats
(
    id          BIGINT PRIMARY KEY,
    seat_number INTEGER                      NOT NULL,
    row_number  INTEGER                      NOT NULL,
    room_id     BIGINT REFERENCES rooms (id) NOT NULL,
    UNIQUE (seat_number, row_number, room_id)
);

CREATE TABLE IF NOT EXISTS reservations
(
    id           BIGINT PRIMARY KEY,
    first_name   VARCHAR(30)                       NOT NULL,
    last_name    VARCHAR(30)                       NOT NULL,
    total_amount NUMERIC(15, 3)                    NOT NULL,
    expire_time  timestamp                         NOT NULL,
    screening_id BIGINT REFERENCES screenings (id) NOT NULL
);

CREATE TABLE IF NOT EXISTS reserved_seats
(
    id             BIGINT PRIMARY KEY,
    seat_id        BIGINT REFERENCES seats (id)        NOT NULL,
    reservation_id BIGINT REFERENCES reservations (id) NOT NULL
);

INSERT INTO rooms
VALUES (1, 'GREEN'),
       (2, 'RED'),
       (3, 'BLUE');

INSERT INTO screenings
VALUES (1, 'Harry Potter', '2020-03-24 10:45:00.000000', 1),
       (2, 'Harry Potter', '2020-03-24 11:25:00.000000', 3),
       (3, 'Matrix', '2020-03-24 12:50:00.000000', 2),
       (4, 'Matrix', '2020-03-24 14:45:00.000000', 1),
       (5, 'Hobbit', '2020-03-24 16:20:00.000000', 2),
       (6, 'Hobbit', '2020-03-24 15:35:00.000000', 3),
       (7, 'Lord of the Rings', '2020-03-24 19:10:00.000000', 2),
       (8, 'Lord of the Rings', '2020-03-24 18:20:00.000000', 1),
       (9, 'The Godfather', '2020-03-24 20:10:00.000000', 3);

INSERT INTO seats (id, seat_number, row_number, room_id)
VALUES (1, 1, 1, 1),
       (2, 2, 1, 1),
       (3, 3, 1, 1),
       (4, 4, 1, 1),
       (5, 5, 1, 1),
       (6, 6, 1, 1),
       (7, 1, 2, 1),
       (8, 2, 2, 1),
       (9, 3, 2, 1),
       (10, 4, 2, 1),
       (11, 5, 2, 1),
       (12, 6, 2, 1),
       (13, 1, 3, 1),
       (14, 2, 3, 1),
       (15, 3, 3, 1),
       (16, 4, 3, 1),
       (17, 5, 3, 1),
       (18, 6, 3, 1),
       (19, 1, 4, 1),
       (20, 2, 4, 1),
       (21, 3, 4, 1),
       (22, 4, 4, 1),
       (23, 5, 4, 1),
       (24, 6, 4, 1),
       (25, 1, 5, 1),
       (26, 2, 5, 1),
       (27, 3, 5, 1),
       (28, 4, 5, 1),
       (29, 5, 5, 1),
       (30, 6, 5, 1),
       (31, 1, 6, 1),
       (32, 2, 6, 1),
       (33, 3, 6, 1),
       (34, 4, 6, 1),
       (35, 5, 6, 1),
       (36, 6, 6, 1),
       (37, 1, 7, 1),
       (38, 2, 7, 1),
       (39, 3, 7, 1),
       (40, 4, 7, 1),
       (41, 5, 7, 1),
       (42, 6, 7, 1),
       (43, 1, 8, 1),
       (44, 2, 8, 1),
       (45, 3, 8, 1),
       (46, 4, 8, 1),
       (47, 5, 8, 1),
       (48, 6, 8, 1),
       (49, 1, 9, 1),
       (50, 2, 9, 1),
       (51, 3, 9, 1),
       (52, 4, 9, 1),
       (53, 5, 9, 1),
       (54, 6, 9, 1),
       -------------
       (55, 1, 1, 2),
       (56, 2, 1, 2),
       (57, 3, 1, 2),
       (58, 4, 1, 2),
       (59, 5, 1, 2),
       (60, 6, 1, 2),
       (61, 1, 2, 2),
       (62, 2, 2, 2),
       (63, 3, 2, 2),
       (64, 4, 2, 2),
       (65, 5, 2, 2),
       (66, 6, 2, 2),
       (67, 1, 3, 2),
       (68, 2, 3, 2),
       (69, 3, 3, 2),
       (70, 4, 3, 2),
       (71, 5, 3, 2),
       (72, 6, 3, 2),
       (73, 1, 4, 2),
       (74, 2, 4, 2),
       (75, 3, 4, 2),
       (76, 4, 4, 2),
       (77, 5, 4, 2),
       (78, 6, 4, 2),
       (79, 1, 5, 2),
       (80, 2, 5, 2),
       (81, 3, 5, 2),
       (82, 4, 5, 2),
       (83, 5, 5, 2),
       (84, 6, 5, 2),
       (85, 1, 6, 2),
       (86, 2, 6, 2),
       (87, 3, 6, 2),
       (88, 4, 6, 2),
       (89, 5, 6, 2),
       (90, 6, 6, 2),
       (91, 1, 7, 2),
       (92, 2, 7, 2),
       (93, 3, 7, 2),
       (94, 4, 7, 2),
       (95, 5, 7, 2),
       (96, 6, 7, 2),
       (97, 1, 8, 2),
       (98, 2, 8, 2),
       (99, 3, 8, 2),
       (100, 4, 8, 2),
       (101, 5, 8, 2),
       (102, 6, 8, 2),
       (103, 1, 9, 2),
       (104, 2, 9, 2),
       (105, 3, 9, 2),
       (106, 4, 9, 2),
       (107, 5, 9, 2),
       (108, 6, 9, 2),
       -------------
       (109, 1, 1, 3),
       (110, 2, 1, 3),
       (111, 3, 1, 3),
       (112, 4, 1, 3),
       (113, 5, 1, 3),
       (114, 6, 1, 3),
       (115, 1, 2, 3),
       (116, 2, 2, 3),
       (117, 3, 2, 3),
       (118, 4, 2, 3),
       (119, 5, 2, 3),
       (120, 6, 2, 3),
       (121, 1, 3, 3),
       (122, 2, 3, 3),
       (123, 3, 3, 3),
       (124, 4, 3, 3),
       (125, 5, 3, 3),
       (126, 6, 3, 3),
       (127, 1, 4, 3),
       (128, 2, 4, 3),
       (129, 3, 4, 3),
       (130, 4, 4, 3),
       (131, 5, 4, 3),
       (132, 6, 4, 3),
       (133, 1, 5, 3),
       (134, 2, 5, 3),
       (135, 3, 5, 3),
       (136, 4, 5, 3),
       (137, 5, 5, 3),
       (138, 6, 5, 3),
       (139, 1, 6, 3),
       (140, 2, 6, 3),
       (141, 3, 6, 3),
       (142, 4, 6, 3),
       (143, 5, 6, 3),
       (144, 6, 6, 3),
       (145, 1, 7, 3),
       (146, 2, 7, 3),
       (147, 3, 7, 3),
       (148, 4, 7, 3),
       (149, 5, 7, 3),
       (150, 6, 7, 3),
       (151, 1, 8, 3),
       (152, 2, 8, 3),
       (153, 3, 8, 3),
       (154, 4, 8, 3),
       (155, 5, 8, 3),
       (156, 6, 8, 3),
       (157, 1, 9, 3),
       (158, 2, 9, 3),
       (159, 3, 9, 3),
       (160, 4, 9, 3),
       (161, 5, 9, 3),
       (162, 6, 9, 3);
